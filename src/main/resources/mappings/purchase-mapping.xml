<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="PURCHASE">
 
	<select id="getPurchaseList" resultType="com.eighty.purchase.PurchaseVO">
    	SELECT * FROM purchase
    	<where>
        	<if test="userId != null and userId != ''">
            	AND userId = #{userId}
        	</if>
    	</where>
    	ORDER BY orderCode DESC
	</select>
	
	<select id="getPurchaseListOne" resultType="com.eighty.purchase.PurchaseVO">
    	SELECT * FROM purchase
    	where orderCode = #{orderCode}
	</select>
	
	<insert id="insertReview" parameterType="ReviewVO">
    	INSERT INTO review (reviewId, orderCode, productCode, userId, content, reg_date)
    	VALUES (review_seq.NEXTVAL, #{orderCode}, #{productCode}, #{userId}, #{content}, SYSDATE)
	</insert>

	<insert id="insertPurchase" parameterType="java.util.List">
    INSERT INTO purchase (orderCode, userId, productCode, productName, productWeight, crushing, orderPrice, 
                        orderCount, receiverName,  receiverPhone, address, orderMemo, paymentMethod, orderStatus, isReview) 
                VALUES 
    <foreach collection="list" item="item" separator=",">
    (#{item.orderCode},#{item.userId},#{item.productCode},#{item.productName},#{item.productWeight}, #{item.crushing},#{item.orderPrice},
        #{item.orderCount},#{item.receiverName},#{item.receiverPhone},#{item.address},#{item.orderMemo},#{item.paymentMethod}, #{item.orderStatus}, #{item.isReview})
    </foreach>
</insert>

</mapper>